"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const state_1 = require("./state");
const view_1 = require("./view");
const names = ["moshe", "liav", "amit"];
let postCount = 0, preCount = 0;
const state1 = state_1.createState({ name: names[0] });
const state2 = state_1.createState({ name: names[1] });
const state3 = state_1.createState({ name: names[2] });
const transform = (sources, { oldData, context }) => {
    const names = [];
    for (let s of sources) {
        if (s.dispatcher) {
            s = s.dispatcher;
        }
        names.push(s.state.name);
    }
    return names;
};
const view = view_1.createView({
    transform,
    dispatchers: [
        state1,
        {
            dispatcher: state2,
            onDispatch: {
                pre: () => preCount++,
                post: () => postCount++
            }
        },
        state3
    ]
});
state2.setState({ name: names[0] });
expect(view.data).toEqual(names);
